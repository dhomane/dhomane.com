{"ast":null,"code":"import _slicedToArray from\"/var/www/html/startup/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import Logo from\"@/components/Logo\";import Stepper from\"@/components/Stepper\";import BasicInfo from\"@/views/BasicInfo\";import Configurator from\"@/views/Configurator\";import EndScreen from\"@/views/EndScreen/index\";import GameOver from\"@/views/GameOver\";import StartScreen from\"@/views/Start\";import Stats from\"@/views/Stats\";import React,{useEffect,useRef,useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import\"./App.css\";import{uiActions}from\"./redux/ui\";import{Config}from\"./utils/config\";import CharacterDisplay from\"./views/Character\";import IdleScreen from\"./views/IdleScreen\";var guidRegex=/^\\/[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i;var App=function App(){var appRef=useRef(null);var _useSelector=useSelector(function(store){return store.ui;}),showGameOver=_useSelector.showGameOver,isIdle=_useSelector.isIdle,isCharacterDisplay=_useSelector.isCharacterDisplay;var _useState=useState(new Config()),_useState2=_slicedToArray(_useState,1),config=_useState2[0];var dispatch=useDispatch();useEffect(function(){config.persistEventID();if(appRef.current){var app=appRef.current;var _app$getBoundingClien=app.getBoundingClientRect(),width=_app$getBoundingClien.width,height=_app$getBoundingClien.height;var onResize=function onResize(){var scale=Math.min(window.innerWidth/width,window.innerHeight/height);app.style.transform=\"translate(-50%, -50%) scale(\".concat(scale,\")\");};window.addEventListener(\"resize\",onResize);onResize();return function(){return window.removeEventListener(\"resize\",onResize);};}},[appRef,config]);useEffect(function(){if(window.location.pathname===\"/logged-in\"){window.history.pushState(null,window.document.title,\"/\");dispatch(uiActions.setIdle(false));dispatch(uiActions.navigateTo(1));}else if(guidRegex.test(window.location.pathname)){dispatch(uiActions.displayCharacter());}},[dispatch]);var steps=[{name:\"start\",component:StartScreen},{name:\"basic-info\",component:BasicInfo},{name:\"configure\",component:Configurator},{name:\"stats\",component:Stats},{name:\"end\",component:EndScreen}];return React.createElement(\"div\",{className:\"app\",ref:appRef},isIdle?React.createElement(IdleScreen,{onExit:function onExit(){return dispatch(uiActions.setIdle(false));}}):isCharacterDisplay?React.createElement(React.Fragment,null,React.createElement(CharacterDisplay,null),React.createElement(Logo,null)):React.createElement(React.Fragment,null,React.createElement(Stepper,{steps:steps}),showGameOver&&React.createElement(GameOver,null),React.createElement(Logo,null),React.createElement(\"span\",{className:\"flash\"})));};export default App;","map":{"version":3,"sources":["/var/www/html/startup/src/App.tsx"],"names":["Logo","Stepper","BasicInfo","Configurator","EndScreen","GameOver","StartScreen","Stats","React","useEffect","useRef","useState","useDispatch","useSelector","uiActions","Config","CharacterDisplay","IdleScreen","guidRegex","App","appRef","store","ui","showGameOver","isIdle","isCharacterDisplay","config","dispatch","persistEventID","current","app","getBoundingClientRect","width","height","onResize","scale","Math","min","window","innerWidth","innerHeight","style","transform","addEventListener","removeEventListener","location","pathname","history","pushState","document","title","setIdle","navigateTo","test","displayCharacter","steps","name","component"],"mappings":"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","sourcesContent":["import Logo from \"@/components/Logo\";\nimport Stepper from \"@/components/Stepper\";\nimport { IStoreState } from \"@/interfaces/IStoreState\";\nimport BasicInfo from \"@/views/BasicInfo\";\nimport Configurator from \"@/views/Configurator\";\nimport EndScreen from \"@/views/EndScreen/index\";\nimport GameOver from \"@/views/GameOver\";\nimport StartScreen from \"@/views/Start\";\nimport Stats from \"@/views/Stats\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Dispatch } from \"redux\";\nimport \"./App.css\";\nimport { uiActions } from \"./redux/ui\";\nimport { Config } from \"./utils/config\";\nimport CharacterDisplay from \"./views/Character\";\nimport IdleScreen from \"./views/IdleScreen\";\n\nconst guidRegex = /^\\/[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i;\n\nconst App: React.FC = () => {\n  const appRef: React.RefObject<HTMLDivElement> = useRef(null);\n  const { showGameOver, isIdle, isCharacterDisplay } = useSelector((store: IStoreState) => store.ui);\n\n  const [config] = useState(new Config());\n  const dispatch: Dispatch = useDispatch();\n\n  useEffect(() => {\n    config.persistEventID();\n    if (appRef.current) {\n      const app = appRef.current;\n      const { width, height } = app.getBoundingClientRect();\n\n      const onResize = () => {\n        const scale = Math.min(window.innerWidth / width, window.innerHeight / height);\n        app.style.transform = `translate(-50%, -50%) scale(${scale})`;\n      };\n\n      window.addEventListener(\"resize\", onResize);\n\n      onResize();\n\n      return () => window.removeEventListener(\"resize\", onResize);\n    }\n  }, [appRef, config]);\n\n  useEffect(() => {\n    if (window.location.pathname === \"/logged-in\") {\n      window.history.pushState(null, window.document.title, \"/\");\n      dispatch(uiActions.setIdle(false));\n      dispatch(uiActions.navigateTo(1));\n    } else if (guidRegex.test(window.location.pathname)) {\n      dispatch(uiActions.displayCharacter());\n    }\n  }, [dispatch]);\n\n  const steps = [\n    { name: \"start\", component: StartScreen },\n    { name: \"basic-info\", component: BasicInfo },\n    { name: \"configure\", component: Configurator },\n    { name: \"stats\", component: Stats },\n    { name: \"end\", component: EndScreen },\n  ];\n\n  return (\n    <div className=\"app\" ref={appRef}>\n      {isIdle ? (\n        <IdleScreen onExit={() => dispatch(uiActions.setIdle(false))} />\n      ) : isCharacterDisplay ? (\n        <>\n          <CharacterDisplay />\n          <Logo />\n        </>\n      ) : (\n        <>\n          <Stepper steps={steps} />\n          {showGameOver && <GameOver />}\n          <Logo />\n          <span className=\"flash\" />\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}